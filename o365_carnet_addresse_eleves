#Carnet d'adresse élèves
-----------------------------------------------------------------

get-GlobalAddressList | fl

IsDefaultGlobalAddressList   : False
Name                         : GAL_Eleves
RecipientFilter              : CustomAttribute1 -eq 'Eleves'
LdapRecipientFilter          : (extensionAttribute1=Eleves)
Identity                     : \GAL_Eleves
Id                           : \GAL_Eleves
-----------------------------------------------------------------

get-AddressBookPolicy | fl

AddressLists       : {\AL_Eleves}
GlobalAddressList  : \GAL_Eleves
RoomList           : \AL_Eleves_Resources
OfflineAddressBook : \OAB_Eleves
IsDefault          : False
Name               : ABP_Eleves
Identity           : ABP_Eleves
Id                 : ABP_Eleves
-----------------------------------------------------------------


Set-Mailbox -Identity $UPN_Eleve -AddressBookPolicy "ABP_Eleves"

##First we create a Resource List for the Students

New-AddressList -name “AL_Students_Resources” -RecipientFilter {(((RecipientDisplayType -eq ‘ConferenceRoomMailbox’) -or (RecipientDisplayType -eq ‘SyncedConferenceRoomMailbox’)) -and (CustomAttribute1 -eq “Student”))} -DisplayName “Student Room List”

##Second we create an Address List for the Students

New-AddressList -name “AL_Students” -RecipientFilter {(RecipientType -eq ‘UserMailbox’) -and (CustomAttribute1 -eq “Student”)} –DisplayName “Student Address List”

##Third we create an Address List for the Students

New-GlobalAddressList -name “GAL_Students” -RecipientFilter {(CustomAttribute1 -eq “Student”)}

##Fourth we create an Offline Address Book for Students

New-OfflineAddressBook -name “OAB_Students” -AddressLists “GAL_Students”

##When we’ve created all these list we need an Address Book Policy

New-AddressBookPolicy -name “ABP_Students” -AddressLists “AL_Students” -OfflineAddressBook “\OAB_Students” -GlobalAddressList “\GAL_Students” -RoomList “\AL_Students_Resources”

##Finally assign the ABP to the Students:

Get-Mailbox -resultsize unlimited | where {$_.CustomAttribute1 -eq “Student”} | Set-Mailbox -AddressBookPolicy “ABP_Students”

##When you do the final test, you’ll see that mailboxes that have Student as the value of the CustomAttribute1, will only see students.



